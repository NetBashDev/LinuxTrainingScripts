#!/bin/bash

# Archivo de salida
SALIDA="Traza de permisos"

# Pedir al usuario los directorios o archivos a checar
echo "[+] Porfavor, Ingrese los directorios o archivos que desea verificar, (Seleccion multiple, separados por espacios [+]"
read -r INPUT

# Usar directorios predeterminados si no se ingresa nada
if [ -z "$INPUT" ]; then
    echo "[+]No se ingresaron rutas. [+] Usando lista predeterminada..."
    DIRECTORIOS=(
        "/etc"
        "/usr/bin"
        "/usr/local/bin"
        "/var"
        "/home"
        "/tmp"
        "/root"
        "/opt"
    )
else
    # Convertir la entrada del usuario en un array
    IFS=' ' read -r -a DIRECTORIOS <<< "$INPUT"
fi

# Crear o limpiar archivo de salida
echo "Traza de permisos de directorios/archivos - Timestamp $(date)" > $SALIDA
echo "===================================================" >> $SALIDA

# Recolectar informaciÃ³n de permisos
for RUTA in "${DIRECTORIOS[@]}"; do
    if [ -e "$RUTA" ]; then
        echo "Path del directorio: $RUTA" >> $SALIDA
        ls -ld "$RUTA" >> $SALIDA
        echo "" >> $SALIDA
    else
        echo "Path no encontrado: $RUTA" >> $SALIDA
        echo "" >> $SALIDA
    fi
done

# Mostrar mensaje final
echo "Reporte generado en: $SALIDA"
